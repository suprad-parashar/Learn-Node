<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Meta Tags -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="au theme template">
    <meta name="author" content="Hau Nguyen">
    <meta name="keywords" content="au theme template">

    <title>Change password</title>
    <link rel="icon" type="image/png" href="/views/home/img/playstore.png">
    <!-- CSS -->
    <link href="views/dashboard/css/font-face.min.css" rel="stylesheet" media="all">
    <link href="views/dashboard/css/theme.min.css" rel="stylesheet" media="all">

    <link href="views/dashboard/vendor/font-awesome-4.7/css/font-awesome.min.css" rel="stylesheet" media="all">
    <link href="views/dashboard/vendor/font-awesome-5/css/fontawesome-all.min.css" rel="stylesheet" media="all">
    <link href="views/dashboard/vendor/mdi-font/css/material-design-iconic-font.min.css" rel="stylesheet" media="all">
    <link href="views/dashboard/vendor/bootstrap-4.1/bootstrap.min.css" rel="stylesheet" media="all">
    <link href="views/dashboard/vendor/animsition/animsition.min.css" rel="stylesheet" media="all">
    <link href="views/dashboard/vendor/bootstrap-progressbar/bootstrap-progressbar-3.3.4.min.css" rel="stylesheet"
          media="all">
    <link href="views/dashboard/vendor/wow/animate.min.css" rel="stylesheet" media="all">
    <link href="views/dashboard/vendor/css-hamburgers/hamburgers.min.css" rel="stylesheet" media="all">
    <link href="views/dashboard/vendor/slick/slick.min.css" rel="stylesheet" media="all">
    <link href="views/dashboard/vendor/select2/select2.min.css" rel="stylesheet" media="all">
    <link href="views/dashboard/vendor/perfect-scrollbar/perfect-scrollbar.min.css" rel="stylesheet" media="all">
</head>

<body class="animsition">
<div class="page-wrapper">
    <!-- Include Dashboard Side Navigation Bar -->
    <%- include("../partials/dashboard_side_nav.ejs") %>

    <div class="page-container">
        <!-- Include Dashboard Header -->
        <%- include("../partials/dashboard_header.ejs") %>

        <div class="main-content">
            <div class="section__content section__content--p30">
                <div class="container-fluid">
                    <div class="col-lg-12">
                        <div class="au-card">
                            <div class="card-body card-block">
                                <form method="post" action="javascript:validatePassword()" id="change-password-form">
                                    <div class="form-group">
                                        <label for="current" class=" form-control-label">Current Password</label>
                                        <input type="password" id="current" placeholder="Current Password"
                                               class="form-control" name="current" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="new" class=" form-control-label">New Password</label>
                                        <input type="password" id="new" placeholder="New Password"
                                               class="form-control" name="new" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="confirm" class=" form-control-label">Confirm Password</label>
                                        <input type="password" id="confirm" placeholder="Confirm Password"
                                               class="form-control" name="confirm" required>
                                    </div>
                                    <input class="au-btn au-btn-icon au-btn--blue" type="submit" value="Save" style="margin: 5px; border: 2px solid #8C54A1">
                                    <a href="/profile"><input class="au-btn au-btn-icon au-btn--blue" type="button" value="Cancel" style="margin: 5px; background-color: white; border: 2px solid #8C54A1;color: #8C54A1" href="/profile"></a>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    function validatePassword() {
        let form = document.getElementById("change-password-form");
        let newPassword = document.getElementById("new").value;
        let confirmPassword = document.getElementById("confirm").value;
        if (newPassword.length < 8) {
            alert('Password must contain at least 8 characters');
        } else {
            let upperCase = false;
            let lowerCase = false;
            let number = /\d/.test(newPassword);
            let format = /[ `!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?~]/;
            let hasSpecialCharacter = format.test(newPassword);
            for (let i = 0; i < newPassword.length; i++) {
                if (newPassword[i] === newPassword[i].toLowerCase()) {
                    lowerCase = true;
                } else if (newPassword[i] === newPassword[i].toUpperCase()) {
                    upperCase = true;
                }
            }
            if (!lowerCase) {
                alert('Password must contain at least 1 Lowercase character');
            } else if (!upperCase) {
                alert('Password must contain at least 1 Uppercase character');
            } else if (!number) {
                alert('Password must contain at least 1 Number');
            } else if (!hasSpecialCharacter) {
                alert('Password must contain at least 1 Special character');
            } else if (newPassword !== confirmPassword) {
                alert("Password do not match");
            } else {
                form.method = "POST";
                form.action = "/profile/password";
                form.submit();
            }
        }
    }
</script>

<script src="views/dashboard/vendor/jquery-3.2.1.min.js"></script>
<script src="views/dashboard/vendor/bootstrap-4.1/popper.min.js"></script>
<script src="views/dashboard/vendor/bootstrap-4.1/bootstrap.min.js"></script>
<script src="views/dashboard/vendor/slick/slick.min.js"></script>
<script src="views/dashboard/vendor/wow/wow.min.js"></script>
<script src="views/dashboard/vendor/animsition/animsition.min.js"></script>
<script src="views/dashboard/vendor/bootstrap-progressbar/bootstrap-progressbar.min.js"></script>
<script src="views/dashboard/vendor/counter-up/jquery.waypoints.min.js"></script>
<script src="views/dashboard/vendor/counter-up/jquery.counterup.min.js"></script>
<script src="views/dashboard/vendor/circle-progress/circle-progress.min.js"></script>
<script src="views/dashboard/vendor/perfect-scrollbar/perfect-scrollbar.js"></script>
<script src="views/dashboard/vendor/chartjs/Chart.bundle.min.js"></script>
<script src="views/dashboard/vendor/select2/select2.min.js"></script>

<script src="views/dashboard/js/main.js"></script>
</body>
</html>